{% extends "myldapi/layout.html" %}

{% macro render_attr_vals(attr_vals) %}
    <dl class="row">
    {% for am, value in attr_vals %}            
        {% if am.label  %}
            <dt class="col-sm-3">
                {% if am.predicate.pred_uri %}
                    <a title="{{ am.predicate.comment }}" href="{{ am.predicate.pred_uri }}">{{ am.label }}</a>
                {% else %}
                    {{ am.label }}
                {% endif %}
            </dt>
            <dd class="col-sm-9">
                {% if am.child_attrs %}
                {% else %}
                    {% if value.uri %}
                        <a href="{{ value.uri }}">
                            {% if value.label %}
                                {{ value.label }}
                            {% else %}
                                {{ value.value }}
                            {% endif %}
                        </a>
                    {% else %}
                        {% if value.label %}
                            {{ value.label }}
                        {% else %}
                            {{ value.value }}
                        {% endif %}
                    {% endif %}
                {% endif %}
            </dd>        
            {% if am.child_attrs %}
                <div class="object-indent">
                {% for child_attr_vals in value %}            
                    {{ render_attr_vals(child_attr_vals) }}
                {% endfor %}
                </div>
            {% endif %}
        {% endif %}
    {% endfor %}
    </dl>
{% endmacro %}

{% block extra_head_css%}
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css" />
{% endblock %}
{% block extra_head_javascript%}
<script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"></script>
<script src="{{ url_for('myldapi.static', filename='proj4-compressed.js') }}"></script>
<script src="{{ url_for('myldapi.static', filename='proj4leaflet.js') }}"></script>
{% endblock %}

{% block content %}
<section class="myldapi-section">
    <div class="row">
        <div class="col-12">
            <h1><a href="{{type_uri}}">{{ type_name }}</a> {{ id }}</h1>
            <p class="lead">{{ uri }}</p>
        </div>
    </div>

    {% include "myldapi/map.html" %}

    <!-- <div class="row"> -->
        {{ render_attr_vals(attr_map_vals) }}
    <!-- </div> -->
</section>

<section class="myldapi-section">
    <div class="row">
        <div class="col-12">
            <h3>Other Views</h3>
            <p>Other views/representations/profiles of this object can be found in the <a href="?_view=alternates&_format=text/html">alternates view</a></p>
        </div>
    </div>
</section>

<section class="myldapi-section">
    <div class="row">
        <div class="col-12">
            <h3>Citation</h3>
            <p>If you wish to cite this Catchment as you would a publication, please use the following format:</p>
            <blockquote class="blockquote citation">
                <p class="ml-0">
                    {{config.CITATION_TEMPLATE.format(type=type_name, id=id, uri=uri, dataset=dataset_name)}}
                </p>
            </blockquote>
        </div>
    </div>
</section>

{% endblock %}